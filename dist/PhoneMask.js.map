{"version":3,"sources":["../PhoneMask.js"],"names":["PhoneMask","param","result","mask","inputs","nodes","document","querySelectorAll","init","node","input","type","querySelector","value","replace","addEventListener","target","caretPosition","indexOf","setSelectionRange","setValue","bind","data","i","match","symbolsArray","lastSymbol","length","lastIndexOf"],"mappings":"4XACMA,U,YAIJ,WAAYC,CAAZ,CAAmB,8BAFnBC,MAEmB,CAFV,EAEU,CACjB,KAAKC,IAAL,CAAYF,EAAME,IAAN,EAAc,oBADT,CAGf,KAAKC,MAHU,CAEbH,EAAMI,KAFO,CAGDJ,EAAMI,KAHL,CAKDC,SAASC,gBAAT,CAA0B,iBAA1B,CALC,CAOjB,KAAKC,IAAL,EACD,C,qDAEM,4BACL,YAAiB,KAAKJ,MAAtB,gDAA8B,IAArBK,EAAqB,SACxBC,EAAQD,CADgB,CAEV,OAAd,KAAKE,IAFmB,GAEDD,EAAQD,EAAKG,aAAL,CAAmB,OAAnB,CAFP,EAGdF,EAAMG,KAHQ,CAK5BH,EAAMG,KAAN,CAAc,KAAKV,IAAL,CAAUW,OAAV,CAAkB,KAAlB,CAAyB,GAAzB,CALc,CAM5BJ,EAAMK,gBAAN,CAAuB,OAAvB,CAAgC,WAAoB,IAATC,EAAS,GAATA,MAAS,CAC5CH,EAAQG,EAAOH,KAD6B,CAE5CI,EAAgBJ,EAAMK,OAAN,CAAc,GAAd,CAF4B,CAGlDF,EAAOG,iBAAP,CAAyBF,CAAzB,CAAwCA,CAAxC,CACD,CAJD,CAN4B,CAW5BP,EAAMK,gBAAN,CAAuB,OAAvB,CAAgC,KAAKK,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAhC,CACD,CAbI,8EAcN,CAED;;;;0CAKyB,IAAfC,EAAe,GAAfA,IAAe,CAATN,CAAS,GAATA,MAAS,CACvB,KAAKd,MAAL,CAAc,EADS,CAEvB,GAAIW,GAAQG,EAAOH,KAAnB,CACA,IAAK,GAAIU,EAAT,GAAc,MAAKpB,IAAnB,CAE0C,KAAKD,MAF/C,EACuB,GAAjB,QAAKC,IAAL,CAAUoB,CAAV,CADN,CAEQV,EAAMU,CAAN,GAAYV,EAAMU,CAAN,EAASC,KAAT,CAAe,IAAf,CAFpB,CAEyDX,EAAMU,CAAN,CAFzD,CAGwB,GAHxB,CAIsB,KAAKpB,IAAL,CAAUoB,CAAV,CAJtB,CAOA,GADAP,EAAOH,KAAP,CAAe,KAAKX,MACpB,CAAIoB,CAAJ,CAAU,KAAKL,aAAL,CAAqB,KAAKf,MAAL,CAAYgB,OAAZ,CAAoB,GAApB,CAArB,CAAV,IACK,IACGO,GAAe,KAAKvB,MAAL,CAAYsB,KAAZ,CAAkB,KAAlB,CADlB,CAEGE,EAAaD,EAAaA,EAAaE,MAAb,CAAsB,CAAnC,CAFhB,CAGH,KAAKV,aAAL,CAAqB,KAAKf,MAAL,CAAY0B,WAAZ,CAAwBF,CAAxB,EAAsC,CAC5D,CACDV,EAAOG,iBAAP,CAAyB,KAAKF,aAA9B,CAA6C,KAAKA,aAAlD,CACD,C","file":"PhoneMask.js","sourcesContent":["\r\nclass PhoneMask {\r\n  mask\r\n  result = ''\r\n  caretPosition\r\n  constructor(param) {\r\n    this.mask = param.mask || '+7 (9xx) xxx xx xx'\r\n    if (param.nodes)\r\n      this.inputs = param.nodes\r\n    else\r\n      this.inputs = document.querySelectorAll(\".k1-phone-input\")\r\n\r\n    this.init()\r\n  }\r\n\r\n  init() {\r\n    for (let node of this.inputs) {\r\n      let input = node\r\n      if (node.type !== 'input') input = node.querySelector(\"input\")\r\n      const value = input.value\r\n\r\n      input.value = this.mask.replace(/x/gi, \"_\")\r\n      input.addEventListener(\"focus\", function ({target}) {\r\n        const value = target.value\r\n        const caretPosition = value.indexOf(\"_\")\r\n        target.setSelectionRange(caretPosition, caretPosition)\r\n      })\r\n      input.addEventListener(\"input\", this.setValue.bind(this))\r\n    }\r\n  }\r\n\r\n  /**\r\n   * main func\r\n   * @param data\r\n   * @param target\r\n   */\r\n  setValue({data, target}) {\r\n    this.result = ''\r\n    let value = target.value\r\n    for (let i in this.mask) {\r\n      if (this.mask[i] === 'x')\r\n        if (value[i] && value[i].match(/\\d/)) this.result += value[i]\r\n        else this.result += \"_\"\r\n      else this.result += this.mask[i]\r\n    }\r\n    target.value = this.result\r\n    if (data) this.caretPosition = this.result.indexOf(\"_\")\r\n    else {\r\n      const symbolsArray = this.result.match(/\\d/g)\r\n      const lastSymbol = symbolsArray[symbolsArray.length - 1]\r\n      this.caretPosition = this.result.lastIndexOf(lastSymbol) + 1\r\n    }\r\n    target.setSelectionRange(this.caretPosition, this.caretPosition)\r\n  }\r\n}"]}